function ListItem(e,t,n,r,o,l,i){var s=this
s.Title=ko.observable(decodeEncodedJson(e)),s.Description=ko.observable(decodeEncodedJson(t)),s.FullSizeUrl=ko.observable(n),s.ResizedUrl=ko.observable(r),s.ThumbnailUrl=ko.observable(o),s.LinkUrl=ko.observable(l),s.Sort=ko.observable(i),s.incrementSort=function(){s.Sort(s.Sort()+3)},s.decrementSort=function(){var e=s.Sort()-3
0>e&&(e=0),s.Sort(e)}}function ItemListViewModel(e){var t=this
t.hiddenField=document.getElementById("ItemsJson"),t.handleSortItemChanged=function(e){t.sortItems()
var n=1
for(i=0;i<t.Items().length;i++){var r=t.Items()[i]
r.Sort.silentUpdate(n),n+=2}t.sortItems()},t.Items=ko.observableArray(ko.utils.arrayMap(e,function(e){var e=new ListItem(e.Title,e.Description,e.FullSizeUrl,e.ResizedUrl,e.ThumbnailUrl,e.LinkUrl,e.Sort)
return e.Sort.subscribe(t.handleSortItemChanged),e})),t.addItem=function(e,n,r,o,l,i,s){var u=new ListItem(e,n,r,o,l,i,s)
u.Sort.subscribe(t.handleSortItemChanged),t.Items.push(u)},t.newItemTitle=ko.observable(null),t.newItemDescription=ko.observable(null),t.newItemFullSizeUrl=ko.observable(null),t.newItemResizedUrl=ko.observable(null),t.newItemThumbnailUrl=ko.observable(null),t.newItemLinkUrl=ko.observable(null),t.newItemSort=function(){if(0===t.Items().length)return 1
var e=Math.max.apply(Math,t.Items().map(function(e){return e.Sort()}))
return e+2},t.addNewItem=function(){console.log(t.newItemSort()),t.addItem(t.newItemTitle(),t.newItemDescription(),t.newItemFullSizeUrl(),t.newItemResizedUrl(),t.newItemThumbnailUrl(),t.newItemLinkUrl(),t.newItemSort()),t.newItemTitle(null),t.newItemDescription(null),t.newItemFullSizeUrl(null),t.newItemResizedUrl(null),t.newItemThumbnailUrl(null),t.newItemLinkUrl(null),window.cloudscribeDropAndCrop.clearAllItems()},t.removeItem=function(e){t.Items.remove(e)},t.getCssClass=function(e){return 0===e?"carousel-item active":"carousel-item"},t.dropZoneSuccess=function(e,n){t.newItemFullSizeUrl(n[0].originalUrl),t.newItemResizedUrl(n[0].resizedUrl),t.newItemThumbnailUrl(n[0].thumbUrl)},window.DropZoneSuccessHandler=t.dropZoneSuccess,t.handleCropSave=function(e){t.newItemResizedUrl(e)},window.HandleCropResult=t.handleCropSave,t.serverFileSelected=function(e){t.newItemResizedUrl(e)},window.ServerFileSelected=t.serverFileSelected,t.currentListState=ko.computed(function(){return encodeURIComponent(ko.toJSON(t.Items))}),t.sortItems=function(){t.Items.sort(function(e,t){return e.Sort()<t.Sort()?-1:e.Sort()>t.Sort()?1:0})}}function decodeEncodedJson(e){if(null===e)return e
if(void 0===e)return e
var t=e.replace(/\+/g," ")
return decodeURIComponent(t)}ko.observable.fn.silentUpdate=function(e){this.notifySubscribers=function(){},this(e),this.notifySubscribers=function(){ko.subscribable.fn.notifySubscribers.apply(this,arguments)}},document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("ItemsConfig"),t=JSON.parse(decodeEncodedJson(e.value))
ko.applyBindings(new ItemListViewModel(t))})
