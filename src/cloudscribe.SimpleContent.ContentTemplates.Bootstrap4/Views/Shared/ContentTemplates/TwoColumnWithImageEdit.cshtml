@model cloudscribe.SimpleContent.ContentTemplates.ViewModels.TwoColumnWithImageViewModel
@using cloudscribe.SimpleContent.ContentTemplates
@using Microsoft.AspNetCore.Antiforgery
@inject IStringLocalizer<ContentTemplateResources> sr
@inject IAntiforgery antiforgery
@inject ICkeditorOptionsResolver editorOptionsResolver
@{

    var tokens = antiforgery.GetAndStoreTokens(Context);
    var ckOptions = await editorOptionsResolver.GetCkeditorOptions();
}
<div class="d-flex align-items-stretch">
    <div class="cs-crop-container">
        @if (string.IsNullOrWhiteSpace(Model.ImageUrl))
        {
            <img id="dz1Image" src="/cr/images/550x412.png" />
        }
        else
        {
            <img id="dz1Image" src="@Model.ImageUrl" alt="profile image" />
        }

    </div>
    <div class="d-flex flex-column">
        <div id="dz1" class="cloudscribe-dropzone-standalone" style="cursor:pointer;"
             data-dropzone=""
             data-upload-url="@Url.Action("DropFile", "FileManager")"
             data-anti-forgery-token="@tokens.RequestToken"
             data-file-browse-url="@ckOptions.ImageBrowseUrl"
             data-file-crop-url="@ckOptions.CropFileUrl"
             data-target-path="/media/images"
             data-target-fullsize-input-id="imgUrl1"
             data-target-resized-input-id="imgUrl1Resized"
             data-target-thumb-input-id="imgUrl1Thumb"
             data-target-fullsize-image-id="dz1Image"
             data-target-resized-image-idx="dz1ImageResized"
             data-enable-browse-server="true"
             data-enable-crop="true"
             data-target-thumb-image-idx="dz1ImageThumb"
             data-resize-width="550"
             data-resize-height="412"
             data-create-thumb="false"
             data-resize-image="true"
             data-accepted-files="image/*">
            @sr["Drop file here or click to browse device for file."]
        </div>
        <div class="pl-1 pt-1">
            <div class="d-flex flex-column">
                <button id="dz1-browse-server" type="button" class="mb-1 btn btn-primary collapse">@sr["Browse Server"] <i class="fas fa-search" aria-hidden="true"></i></button>
                <button id="dz1-save-crop" type="button" class="mb-1 btn btn-primary collapse">@sr["Save Crop"] <i class="far fa-save" aria-hidden="true"></i></button>
            </div>
        </div>
    </div>
</div>
<input asp-for="ImageFullSizeUrl" id="imgUrl1" type="hidden" />
<input asp-for="ImageUrl" id="imgUrl1Resized" type="hidden" />
<input asp-for="ImageThumbSizeUrl" id="imgUrl1Thumb" type="hidden" />
<div class="form-group">
    <label asp-for="ColumnOneContent" class="control-label">@sr["Column 1 Content"]</label>
    <textarea asp-for="ColumnOneContent" class="form-control"></textarea>
    <span asp-validation-for="ColumnOneContent" class="text-danger"></span>
</div>
<div class="form-group">
    <label asp-for="ColumnTwoContent" class="control-label">@sr["Column 2 Content"]</label>
    <textarea asp-for="ColumnTwoContent" class="form-control"></textarea>
    <span asp-validation-for="ColumnTwoContent" class="text-danger"></span>
</div>
<div id="fileBrowseDialog" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg" style="height:99%;min-width:99%!important;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" title="Close"><span aria-hidden="true">&times;</span></button>
            </div>
            <iframe id="frFileDialog" frameborder="0" style="overflow:hidden;height:100%;width:100%;min-height: 650px;"></iframe>
        </div>
    </div>
</div>